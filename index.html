<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <title>Parser var_dump</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 20px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
        }
    </style>
</head>

<body>

    <h1>Parser var_dump</h1>

    <label for="input">Input (var_dump):</label>
    <textarea id="input" placeholder='array(2) {
  ["klucz"]=>
  string(7) "wartosc"
  ["klucz_int"]=>
  int(312)
}'></textarea>

    <button onclick="convert()">Konwertuj</button>

    <label for="output">Output (PHP):</label>
    <textarea id="output" readonly placeholder="$result['klucz'] = 'wartosc';
$result['klucz_int'] = 312;"></textarea>

    <script>
        function convert() {
            const input = document.getElementById('input').value;
            const output = document.getElementById('output');
            const result = [];

            function parseVarDump(varDump, parentKey = '') {
                const regex = /\["(.*?)"\]=>\s*(array\((\d+)\)\s*\{([^{}]*)\}|string\(\d+\) "(.*?)"|int\((\d+)\)|float\((\d+\.\d+)\)|bool\((true|false)\))/g;
                let match;
                const arrayRegex = /array\((\d+)\)\s*\{([^{}]*)\}/g;
                const isEmptyArray = arrayRegex.exec(varDump);

                if (isEmptyArray && isEmptyArray[1] === '0') {
                    result.push(`$result = [];`);
                    return;
                }

                while ((match = regex.exec(varDump)) !== null) {
                    const key = parentKey ? `${parentKey}['${match[1]}']` : `['${match[1]}']`;
                    if (match[2] && match[2].startsWith("array")) {
                        result.push(`$result${key} = [];`);
                        parseVarDump(match[4], key);
                    } else if (match[5] !== undefined) {
                        result.push(`$result${key} = '${match[5]}';`);
                    } else if (match[6] !== undefined) {
                        result.push(`$result${key} = ${match[6]};`);
                    } else if (match[7] !== undefined) {
                        result.push(`$result${key} = ${match[7]};`);
                    } else if (match[8] !== undefined) {
                        result.push(`$result${key} = ${match[8]};`);
                    }
                }
            }

            parseVarDump(input);

            output.value = result.join('\n');
        }
    </script>

</body>

</html>